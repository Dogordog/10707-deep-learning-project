% !TEX root=../report.tex

\section{Experiments}
\label{sec:experiment}

\begin{figure}[htbp]
    \vspace*{-3.5cm}
    \hspace*{-3.5cm} 
    \includegraphics[width=21cm, height=20cm]{1vs1}
	\caption{Plots for average reward, loss, steps and collisions per episode for 1 green vs 1 red agent}\label{Figure 2}
\end{figure}

\begin{figure}[htbp]
    \vspace*{-3.5cm}
    \hspace*{-3.5cm}
    \includegraphics[width=21cm, height=20cm]{1vs2}
	\caption{Plots for average reward, loss, steps and collisions per episode for 2 green vs 1 red agents}\label{Figure 3}
\end{figure}

\begin{figure}[htbp]
    \vspace*{-3.5cm}
    \hspace*{-3.5cm}
    \includegraphics[width=21cm, height=20cm]{2vs1}
	\caption{Plots for average reward, loss, steps and collisions per episode for 1 green vs 2 red agents}\label{Figure 4}
\end{figure}

\begin{comment}
\subsection{One Agent vs. One Adversary Results}
\label{sec:experiment:1vs1}

Figure~\ref{fig:1vs1} plots our results for the predator-pray scenario with one
agent and one adversary. The first row of this figure shows the number of steps
per episode. The second row shows the cumulative reward per episode. The third
row shows the number of collisions per episode. The fourth row shows the
average loss per episode. The first column of Figure~\ref{fig:1vs1} shows the
results for DQN model. The second column shows the results for DDPG model. The
third column shows the results for MADDPG model. The x-axis of each figure is
always number of training episodes. We next analyze these results in turn.


\begin{figure}[h]
  \centering

  \begin{subfigure}[h]{\figscale\linewidth}
    \includegraphics[trim=10 10 10 10,clip,width=\linewidth]
    {../results/dqn_1vs1/steps.png}
    \caption{Number of steps per episode over training episode for DQN.}
    \label{fig:dqn-1vs1-steps}
  \end{subfigure}
  ~
  \begin{subfigure}[h]{\figscale\linewidth}
    \includegraphics[trim=10 10 10 10,clip,width=\linewidth]
    {../results/ddpg_1vs1/steps.png}
    \caption{Number of steps per episode over training episode for DDPG.}
    \label{fig:ddpg-1vs1-steps}
  \end{subfigure}
  ~
  \begin{subfigure}[h]{\figscale\linewidth}
    \includegraphics[trim=10 10 10 10,clip,width=\linewidth]
    {../results/maddpg_1vs1/steps.png}
    \caption{Number of steps per episode over training episode for MADDPG.}
    \label{fig:maddpg-1vs1-steps}
  \end{subfigure}

  \begin{subfigure}[h]{\figscale\linewidth}
    \includegraphics[trim=10 10 10 10,clip,width=\linewidth]
    {../results/dqn_1vs1/reward.png}
    \caption{Cumulative reward per episode over training episode for DQN.}
    \label{fig:dqn-1vs1-reward}
  \end{subfigure}
  ~
  \begin{subfigure}[h]{\figscale\linewidth}
    \includegraphics[trim=10 10 10 10,clip,width=\linewidth]
    {../results/ddpg_1vs1/reward.png}
    \caption{Cumulative reward per episode over training episode for DDPG.}
    \label{fig:ddpg-1vs1-reward}
  \end{subfigure}
  ~
  \begin{subfigure}[h]{\figscale\linewidth}
    \includegraphics[trim=10 10 10 10,clip,width=\linewidth]
    {../results/maddpg_1vs1/reward.png}
    \caption{Cumulative reward per episode over training episode for MADDPG.}
    \label{fig:maddpg-1vs1-reward}
  \end{subfigure}

  \begin{subfigure}[h]{\figscale\linewidth}
    \includegraphics[trim=10 10 10 10,clip,width=\linewidth]
    {../results/dqn_1vs1/collisions.png}
    \caption{Number of collisions per episode over training episode for DQN.}
    \label{fig:dqn-1vs1-collisions}
  \end{subfigure}
  ~
  \begin{subfigure}[h]{\figscale\linewidth}
    \includegraphics[trim=10 10 10 10,clip,width=\linewidth]
    {../results/ddpg_1vs1/collisions.png}
    \caption{Number of collisions per episode over training episode for DDPG.}
    \label{fig:ddpg-1vs1-collisions}
  \end{subfigure}
  ~
  \begin{subfigure}[h]{\figscale\linewidth}
    \includegraphics[trim=10 10 10 10,clip,width=\linewidth]
    {../results/maddpg_1vs1/collisions.png}
    \caption{Number of collisions per episode over training episode for MADDPG.}
    \label{fig:maddpg-1vs1-collisions}
  \end{subfigure}

  \begin{subfigure}[h]{\figscale\linewidth}
    \includegraphics[trim=10 10 10 10,clip,width=\linewidth]
    {../results/dqn_1vs1/loss.png}
    \caption{Average loss per episode over training episode for DQN.}
    \label{fig:dqn-1vs1-loss}
  \end{subfigure}
  ~
  \begin{subfigure}[h]{\figscale\linewidth}
    \includegraphics[trim=10 10 10 10,clip,width=\linewidth]
    {../results/ddpg_1vs1/loss.png}
    \caption{Average loss per episode over training episode for DDPG.}
    \label{fig:ddpg-1vs1-loss}
  \end{subfigure}
  ~
  \begin{subfigure}[h]{\figscale\linewidth}
    \includegraphics[trim=10 10 10 10,clip,width=\linewidth]
    {../results/maddpg_1vs1/loss.png}
    \caption{Average loss per episode over training episode for MADDPG.}
    \label{fig:maddpg-1vs1-loss}
  \end{subfigure}


  \caption{Results for predator-pray with one agent vs. one adversary}
  \label{fig:1vs1}
  \end{figure}
\FloatBarrier


In the first row of Figure~\ref{fig:1vs1}, the blue curve shows the number of
steps for each episode, the black dotted curve shows the running average of
steps per episode with a window size of 50. Note the different y-axis scales
used in different figures. First, we observe that the MADDPG model achieves the
highest peak steps per episode of the three models (i.e., highest steps of
around 5000 achieved at around 55,000 episodes). Second, we find that DQN
achieves the highest average steps per episode of around 300. This shows that
DQN model based agent is has a more stable performance than the other two
models.




\subsection{Two Agents vs. One Adversary Results}
\label{sec:experiment:1vs2}


\begin{figure}[h]
  \centering

  \begin{subfigure}[h]{\figscale\linewidth}
    \includegraphics[trim=10 10 10 10,clip,width=\linewidth]
    {../results/dqn_1vs2/steps.png}
    \caption{Number of steps per episode over training episode for DQN.}
    \label{fig:dqn-1vs2-steps}
  \end{subfigure}
  ~
  \begin{subfigure}[h]{\figscale\linewidth}
    \includegraphics[trim=10 10 10 10,clip,width=\linewidth]
    {../results/ddpg_1vs2/steps.png}
    \caption{Number of steps per episode over training episode for DDPG.}
    \label{fig:ddpg-1vs2-steps}
  \end{subfigure}
  ~
  \begin{subfigure}[h]{\figscale\linewidth}
    \includegraphics[trim=10 10 10 10,clip,width=\linewidth]
    {../results/maddpg_1vs2/steps.png}
    \caption{Number of steps per episode over training episode for MADDPG.}
    \label{fig:maddpg-1vs2-steps}
  \end{subfigure}

  \begin{subfigure}[h]{\figscale\linewidth}
    \includegraphics[trim=10 10 10 10,clip,width=\linewidth]
    {../results/dqn_1vs2/reward.png}
    \caption{Cumulative reward per episode over training episode for DQN.}
    \label{fig:dqn-1vs2-reward}
  \end{subfigure}
  ~
  \begin{subfigure}[h]{\figscale\linewidth}
    \includegraphics[trim=10 10 10 10,clip,width=\linewidth]
    {../results/ddpg_1vs2/reward.png}
    \caption{Cumulative reward per episode over training episode for DDPG.}
    \label{fig:ddpg-1vs2-reward}
  \end{subfigure}
  ~
  \begin{subfigure}[h]{\figscale\linewidth}
    \includegraphics[trim=10 10 10 10,clip,width=\linewidth]
    {../results/maddpg_1vs2/reward.png}
    \caption{Cumulative reward per episode over training episode for MADDPG.}
    \label{fig:maddpg-1vs2-reward}
  \end{subfigure}

  \begin{subfigure}[h]{\figscale\linewidth}
    \includegraphics[trim=10 10 10 10,clip,width=\linewidth]
    {../results/dqn_1vs2/collisions.png}
    \caption{Number of collisions per episode over training episode for DQN.}
    \label{fig:dqn-1vs2-collisions}
  \end{subfigure}
  ~
  \begin{subfigure}[h]{\figscale\linewidth}
    \includegraphics[trim=10 10 10 10,clip,width=\linewidth]
    {../results/ddpg_1vs2/collisions.png}
    \caption{Number of collisions per episode over training episode for DDPG.}
    \label{fig:ddpg-1vs2-collisions}
  \end{subfigure}
  ~
  \begin{subfigure}[h]{\figscale\linewidth}
    \includegraphics[trim=10 10 10 10,clip,width=\linewidth]
    {../results/maddpg_1vs2/collisions.png}
    \caption{Number of collisions per episode over training episode for MADDPG.}
    \label{fig:maddpg-1vs2-collisions}
  \end{subfigure}

  \begin{subfigure}[h]{\figscale\linewidth}
    \includegraphics[trim=10 10 10 10,clip,width=\linewidth]
    {../results/dqn_1vs2/loss.png}
    \caption{Average loss per episode over training episode for DQN.}
    \label{fig:dqn-1vs2-loss}
  \end{subfigure}
  ~
  \begin{subfigure}[h]{\figscale\linewidth}
    \includegraphics[trim=10 10 10 10,clip,width=\linewidth]
    {../results/ddpg_1vs2/loss.png}
    \caption{Average loss per episode over training episode for DDPG.}
    \label{fig:ddpg-1vs2-loss}
  \end{subfigure}
  ~
  \begin{subfigure}[h]{\figscale\linewidth}
    \includegraphics[trim=10 10 10 10,clip,width=\linewidth]
    {../results/maddpg_1vs2/loss.png}
    \caption{Average loss per episode over training episode for MADDPG.}
    \label{fig:maddpg-1vs2-loss}
  \end{subfigure}


  \caption{Results for predator-pray with two agents vs. one adversary}
  \label{fig:1vs2}
\FloatBarrier


\subsection{One Agent vs. Two Adversaries Results}
\label{sec:experiment:2vs1}


\begin{figure}[h]
  \centering

  \begin{subfigure}[h]{\figscale\linewidth}
    \includegraphics[trim=10 10 10 10,clip,width=\linewidth]
    {../results/dqn_2vs1/steps.png}
    \caption{Number of steps per episode over training episode for DQN.}
    \label{fig:dqn-2vs1-steps}
  \end{subfigure}
  ~
  \begin{subfigure}[h]{\figscale\linewidth}
    \includegraphics[trim=10 10 10 10,clip,width=\linewidth]
    {../results/ddpg_2vs1/steps.png}
    \caption{Number of steps per episode over training episode for DDPG.}
    \label{fig:ddpg-2vs1-steps}
  \end{subfigure}
  ~
  \begin{subfigure}[h]{\figscale\linewidth}
    \includegraphics[trim=10 10 10 10,clip,width=\linewidth]
    {../results/maddpg_2vs1/steps.png}
    \caption{Number of steps per episode over training episode for MADDPG.}
    \label{fig:maddpg-2vs1-steps}
  \end{subfigure}

  \begin{subfigure}[h]{\figscale\linewidth}
    \includegraphics[trim=10 10 10 10,clip,width=\linewidth]
    {../results/dqn_2vs1/reward.png}
    \caption{Cumulative reward per episode over training episode for DQN.}
    \label{fig:dqn-2vs1-reward}
  \end{subfigure}
  ~
  \begin{subfigure}[h]{\figscale\linewidth}
    \includegraphics[trim=10 10 10 10,clip,width=\linewidth]
    {../results/ddpg_2vs1/reward.png}
    \caption{Cumulative reward per episode over training episode for DDPG.}
    \label{fig:ddpg-2vs1-reward}
  \end{subfigure}
  ~
  \begin{subfigure}[h]{\figscale\linewidth}
    \includegraphics[trim=10 10 10 10,clip,width=\linewidth]
    {../results/maddpg_2vs1/reward.png}
    \caption{Cumulative reward per episode over training episode for MADDPG.}
    \label{fig:maddpg-2vs1-reward}
  \end{subfigure}

  \begin{subfigure}[h]{\figscale\linewidth}
    \includegraphics[trim=10 10 10 10,clip,width=\linewidth]
    {../results/dqn_2vs1/collisions.png}
    \caption{Number of collisions per episode over training episode for DQN.}
    \label{fig:dqn-2vs1-collisions}
  \end{subfigure}
  ~
  \begin{subfigure}[h]{\figscale\linewidth}
    \includegraphics[trim=10 10 10 10,clip,width=\linewidth]
    {../results/ddpg_2vs1/collisions.png}
    \caption{Number of collisions per episode over training episode for DDPG.}
    \label{fig:ddpg-2vs1-collisions}
  \end{subfigure}
  ~
  \begin{subfigure}[h]{\figscale\linewidth}
    \includegraphics[trim=10 10 10 10,clip,width=\linewidth]
    {../results/maddpg_2vs1/collisions.png}
    \caption{Number of collisions per episode over training episode for MADDPG.}
    \label{fig:maddpg-2vs1-collisions}
  \end{subfigure}

  \begin{subfigure}[h]{\figscale\linewidth}
    \includegraphics[trim=10 10 10 10,clip,width=\linewidth]
    {../results/dqn_2vs1/loss.png}
    \caption{Average loss per episode over training episode for DQN.}
    \label{fig:dqn-2vs1-loss}
  \end{subfigure}
  ~
  \begin{subfigure}[h]{\figscale\linewidth}
    \includegraphics[trim=10 10 10 10,clip,width=\linewidth]
    {../results/ddpg_2vs1/loss.png}
    \caption{Average loss per episode over training episode for DDPG.}
    \label{fig:ddpg-2vs1-loss}
  \end{subfigure}
  ~
  \begin{subfigure}[h]{\figscale\linewidth}
    \includegraphics[trim=10 10 10 10,clip,width=\linewidth]
    {../results/maddpg_2vs1/loss.png}
    \caption{Average loss per episode over training episode for MADDPG.}
    \label{fig:maddpg-2vs1-loss}
  \end{subfigure}
  \caption{Results for predator-pray with one agent vs. two adversaries}
  \label{fig:2vs1}
\end{figure}
\FloatBarrier    
\end{comment}
